/*! 
 * jQuery Bootgrid v0.9.3-alpha - 05/13/2014
 * Copyright (c) 2014 Rafael Staib (http://www.jquery-bootgrid.com)
 * Licensed under MIT http://www.opensource.org/licenses/MIT
 */
!function(a){"use strict";function b(a){return a._bgId()+"-footer"}function c(a){return a._bgId()+"-header"}function d(b,c){var d={current:c.current,rowCount:b.rowCount,sort:c.sort},e=b.post;return e=a.isFunction(e)?e():e,a.extend(!0,d,e)}function e(b){var c=b.url;return a.isFunction(c)?c():c}function f(b){b.loading.fadeOut(300),a(window).off("resize."+p)}function g(b){var c=b.options;b.loading=a(c.templates.loading.resolve({css:c.css.loading,text:c.labels.loading})).appendTo("body"),h(b),j(b),i(b)}function h(b){var c=b.element,d=b.options,e=b.state,f=c.find("thead > tr").first(),g=!1;f.children().each(function(){var b=a(this),c=b.data("custom"),f=b.data("order"),h=b.data("sortable"),i={id:b.data("column-id"),custom:c===!0||1===c,order:g||"asc"!==f&&"desc"!==f?null:f,sortable:!(h===!1||0===h)};e.columns.push(i),null!=i.order&&(e.sort[i.id]=i.order),d.multiSort||null===i.order||(g=!0)})}function i(b){var c=b.element,g=b.options,h=b.state,i=d(g,h),j=e(g);if(null==j||"string"!=typeof j||0===j.length)throw new Error("Url setting must be a none empty string or a function that returns one.");c.trigger("load."+p),o(b),a.post(j,i,function(d){"string"==typeof d&&(d=a.parseJSON(d)),h.current=d.current,h.total=d.total,h.totalPages=Math.round(h.total/h.rowCount),k(c,g,h,d.rows),l(b),f(b),c.trigger("loaded."+p)}).fail(function(){f(b)})}function j(d){var e=d.element,f=d.options,g=f.css,h=f.templates,i=a(h.div.resolve({id:c(e),css:g.header})),j=a(h.div.resolve({id:b(e),css:g.footer}));e.addClass(g.table).before(i).after(j),n(d)}function k(b,c,d,e){var f=c.labels,g=c.templates,h=b.children("tbody").first().empty();e.length>0?a.each(e,function(c,e){var f=a(g.row);a.each(d.columns,function(c,d){d.custom?b.trigger("custom."+p,{cell:a(g.cell.resolve({content:"&nbsp;"})).appendTo(f),column:d,row:e}):f.append(g.cell.resolve({content:e[d.id]||"&nbsp;"}))}),h.append(f)}):h.append(g.noResults.resolve({columns:d.columns.length,text:f.noResults}))}function l(d){var e=d.element,f=d.options,g=d.state,h=f.css,i=f.templates,j=g.current,k=g.totalPages,l=a(i.list.resolve({css:h.pagination})),n=k-j,o=-1*(f.padding-j),p=n>=f.padding?Math.max(o,1):Math.max(o-f.padding+n,1),q=2*f.padding+1,r=k>=q?q:k;m(d,l,"first","&laquo;","first")._bgEnableAria(j>1),m(d,l,"prev","&lt;","prev")._bgEnableAria(j>1);for(var s=0;r>s;s++){var t=s+p;m(d,l,t,t,"page-"+t)._bgEnableAria()._bgSelectAria(t===j)}m(d,l,"next","&gt;","next")._bgEnableAria(k>j),m(d,l,"last","&raquo;","last")._bgEnableAria(k>j),a("#"+b(e)).empty().append(l),f.topPagination&&a("#"+c(e)).empty().append(l.clone(!0))}function m(b,c,d,e,f){var g=b.options,h=b.state,j=g.templates,k=a(j.anchor.resolve({href:"#"+d,text:e})).on("click."+p,function(c){c.preventDefault();var d=a(this);if(!d.parent().hasClass("disabled")){var e={first:1,prev:h.current-1,next:h.current+1,last:h.totalPages},f=d.attr("href").substr(1);h.current=e[f]||+f,i(b)}}),l=a(j.listItem).addClass(f).append(k);return c.append(l),l}function n(b){var c=b.element,d=b.options,e=b.state,f=c.find("thead > tr > th"),g=d.css,h=d.templates;a.each(e.columns,function(c,j){if(j.sortable){var k=e.sort[j.id],l=g.icon+(k&&"asc"===k?" "+g.iconDown:k&&"desc"===k?" "+g.iconUp:"");f.eq(c).addClass(g.sortable).append(" "+h.icon.resolve({css:l})).on("click."+p,function(c){c.preventDefault();var h=a(this),k=e.sort[j.id],l=h.find("."+g.icon);d.multiSort||(f.find("."+g.icon).removeClass(g.iconDown+" "+g.iconUp),e.sort={}),k&&"asc"===k?(e.sort[j.id]="desc",l.removeClass(g.iconDown).addClass(g.iconUp)):k&&"desc"===k?(delete e.sort[j.id],l.removeClass(g.iconUp)):(e.sort[j.id]="asc",l.addClass(g.iconDown)),i(b)})}})}function o(b){a(window).on("resize."+p,function(){var a=b.element,c=a.offset();b.loading.css("left",c.left).css("top",c.top).height(a.height()).width(a.width())}).resize(),b.loading.fadeIn(300)}var p="rs.jquery.bootgrid",q=function(b,c){this.element=a(b),this.options=a.extend(!0,{},q.defaults,this.element.data(),c),this.state={columns:[],current:1,rowCount:this.options.rowCount,sort:{},total:0,totalPages:0},g(this)};q.defaults={post:{},padding:2,rowCount:10,url:"",topPagination:!1,multiSort:!1,css:{footer:"bootgrid-footer",icon:"glyphicon",iconDown:"glyphicon-chevron-down",iconUp:"glyphicon-chevron-up",loading:"bootgrid-loading",pagination:"pagination",header:"bootgrid-header",sortable:"sortable",table:"bootgrid-table table"},labels:{loading:"Loading...",noResults:"No results found!"},templates:{anchor:'<a href="{{href}}">{{text}}</a>',cell:"<td>{{content}}</td>",div:'<div id="{{id}}" class="{{css}}"></div>',icon:'<span class="{{css}}"></span>',list:'<ul class="{{css}}"></ul>',listItem:"<li></li>",loading:'<div class="{{css}}"><div>{{text}}</div></div>',noResults:'<tr><td colspan="{{columns}}" class="no-results">{{text}}</td></tr>',row:"<tr></tr>"}},q.prototype.destroy=function(){this.element.off(p).removeData(p)},q.prototype.reload=function(){this.state.current=1,i(this.element,this.options,this.state)},q.prototype.sort=function(b){var c=b?a.extend({},b):{};return c===this.state.sort?this:(this.state.sort=c,a.each(c,function(){}),this)};var r=a.fn.bootgrid;a.fn.bootgrid=function(b){return this.each(function(){var c=a(this),d=c.data(p),e="object"==typeof b&&b;if(d||"destroy"!==b)return d||c.data(p,d=new q(this,e)),"string"==typeof b?d[b]():void 0})},a.fn.bootgrid.Constructor=q,a.fn.bootgrid.noConflict=function(){return a.fn.bootgrid=r,this},a.fn.extend({_bgAria:function(a,b){return this.attr("aria-"+a,b)},_bgRemoveAria:function(a){return this.removeAttr("aria-"+a)},_bgEnableAria:function(a){return null==a||a?this.removeClass("disabled")._bgAria("disabled","false"):this.addClass("disabled")._bgAria("disabled","true")},_bgShowAria:function(a){return null==a||a?this.show()._bgAria("hidden","false"):this.hide()._bgAria("hidden","true")},_bgSelectAria:function(a){return null==a||a?this.addClass("active")._bgAria("selected","true"):this.removeClass("active")._bgAria("selected","false")},_bgId:function(a){return a?this.attr("id",a):this.attr("id")}}),String.prototype.resolve||(String.prototype.resolve=function(b){var c=this;return a.each(b,function(a,b){var d=new RegExp("\\{\\{"+a+"\\}\\}","gm");c=c.replace(d,b)}),c})}(jQuery);